\section{Reproducibility in Scientific Workflows}
\label{sec:reproducibility}

In this section, we introduce the tools used in this work for the instantiation and evaluation 
of the semantic models aforementioned. We first describe the Pegasus Workflow 
Management System (WMS)~\cite{Pegasus, Deelman-FGCS-2014}, which is used as our 
workflow engine, and then a set of reproducibility tools for semantic annotations and 
experiment management.


\subsection{Scientific Workflow Execution}

The Pegasus WMS can manage workflows comprised of millions of tasks, recording data 
about the execution and intermediate results. In Pegasus, workflows are described as an 
abstract workflows, which do not contain resource information, or the physical locations of 
data and executables. Workflows are described as directed acyclic graphs (DAGs), where 
nodes represent individual computational tasks and the edges represent data and control 
dependencies between tasks. The abstract workflow description is represented as a DAX 
(DAG in XML), capturing all the tasks that perform computation, the execution order of these 
tasks, and for each task the required inputs, expected outputs, and the arguments with which 
the task should be invoked. 

During a workflow execution, Pegasus translates an abstract workflow into an 
executable workflow, determining the executables, data, and computational resources 
required for the execution. Pegasus maps executables to their installation paths or to a 
repository of stageable binaries defined in a Transformation Catalog (TC). A workflow 
execution includes data management, monitoring, and failure handling. Individual workflow 
tasks are managed by a task scheduler (HTCondor~\cite{condor}), which supervises their 
execution on local and remote resources.


\subsection{Reproducibility Tools}

To conduct the evaluation of the semantic models when executing scientific workflows, we 
use the WICUS framework~\cite{wicus}, which comprises the semantic models described 
in Section~\ref{sec:semantic} and a set of tools for annotating and consuming data; and 
the PRECIP~\cite{Azarnoosh-CRC-2013} experiment management tool to manage the 
experiment. In addition, we use Vagrant~\cite{palat2012introducing} to \note{add vagrant description}. 
Below, we describe each of these tools in detail.


\subsubsection{WICUS}
We introduce here the Workflow Infrastructure Conservation Using Semantics ontology 
(WICUS), an OWL2~\cite{OWL2} (Web Ontology Language) ontology network that 
implements the semantic models introduced in Section~\ref{sec:semantic}. This ontology 
network is available online~\cite{wicus-online} and it is a continuous effort to discover and 
define the relevant and required properties for describing scientific computational infrastructures. 

Besides the ontology network, WICUS has a set of modules that facilitates the annotation of 
the resources involved on the execution of a scientific workflow. These tools are not fully 
automated yet, but represent a first step on helping users to define the requirements of their 
experiments. Figure~\ref{fig:wicusflow} shows the main modules, their flow and intermediate 
results involved in the process for achieving reproducibility, and describes the process of 
data generation and consumption. Below, we provide an overview of each of these modules:

\begin{figure}[!htb]
	\centering
	\includegraphics[width=.8\linewidth]{figures/wicusflow}
	\caption{WICUS annotation modules and flow. White boxes represent tools for semantic annotation or algorithms, and grey boxes represent files used or generated by the framework.}
	\label{fig:wicusflow}
\end{figure}

\begin{enumerate}
	\item \textbf{DAX Annotator.} This tool parses a DAX (Pegasus' workflow description) 
		and generates a set of annotations using the terms of the WICUS vocabulary, 
		representing workflow transformations and the workflow infrastructure requirements.

	\item \textbf{Workflow Annotations.} An RDF file containing the description of the workflow 
		and its infrastructure requirements.

	\item \textbf{WMS Annotations.} An RDF file containing the information of the WMS component 
		and its dependencies. This information will be added to the \emph{Software Components 
		Catalog}.

	\item \textbf{Transformation Catalog Annotator.} This tool parses the Pegasus Transformation 
		Catalog (which describes the binaries involved on the workflow execution and their locations) 
		and the WMS annotations file, to generate two set of annotations: the \emph{Software 
		Components Catalog} and the \emph{Workflow \& Configuration Annotation} files.

	\item \textbf{Software Components Catalog.} An RDF file containing the set of annotations about 
		the binaries, dependencies, deployment plans and scripts, and configuration information of 
		the software involved in the experiment.

	\item \textbf{Workflow \& Configuration Annotation File.} An RDF file containing the same information 
		as in 2, but enriched with the configuration information for each workflow execution step, as 
		specified in the transformation catalog.

	\item \textbf{Scientific Virtual Appliances Catalog.} An RDF file describing available VM appliances. 
		Information about the related infrastructure providers and the VM images that compose an 
		appliance are included in this dataset.

	\item \textbf{Infrastructure Specification Algorithm.} This process reads files 5, 6, and 7, and 
		generates a configuration file (e.g., a PRECIP script), which describes VMs and software 
		components to be created and deployed.

	\item \textbf{PRECIP script.} This script creates a PRECIP experiment, which runs a VM, copies 
		the required binaries, and executes deployment scripts to set the environment for the workflow 
		execution. It also contains the PRECIP commands from the original experiment in order to 
		re-execute it.

\end{enumerate}

In the experimental evaluation (Section~\ref{sec:experiment}), we will present a detailed description 
and the applicability of each module for the studied scientific workflows.



% PRECIP
\subsubsection{PRECIP}
The Pegasus Repeatable Experiments for the Cloud in Python (PRECIP)~\cite{Azarnoosh-CRC-2013} 
is a flexible experiment management control API for running experiments on all types of Clouds, 
including academic Clouds such as FutureGrid~\cite{futuregrid} and the NSFCloud~\cite{chameleon,cloudlab}, 
and commercial Clouds such as Amazon EC2~\cite{aws} and Google Compute Engine~\cite{gce}. 
In PRECIP, interactions with the provisioned instances are done by tagging. When an instance is 
provisioned, the scientist can add arbitrary tags to that instance in order to identify and group the 
instances in the experiment. API methods such as running remote commands, or copying files, all 
use tags to specify which instances to target. PRECIP does not force the scientist to use a special 
VM image, and no PRECIP components need to be pre-installed in the image. Scientists can use 
any basic Linux image and PRECIP will bootstrap instances using SCP and SSH commands. 
PRECIP provides functionality to run user-defined scripts on the instances to install/configure 
software and run experiments, and also manages SSH keys and security groups automatically.

In this work, PRECIP usage is twofold. First, the tool is used to describe and perform a workflow 
execution using the Pegasus WMS on a predefined VM image. Second, the WICUS annotation 
modules use PRECIP to generate a script able to reproduce the execution environment of the 
former experiment, and run it on different Cloud platforms.


% Vagrant
\subsubsection{Vagrant}

\note{Idafen to add some text about Vagrant.}

